<!DOCTYPE html>
<html>

<%= javascript_include_tag "chartkick", "Chart.bundle" %>
<%= javascript_include_tag "application", type: "module" %>

<head>
  <meta charset="utf-8">
  <title><%= content_for(:title) || "Papillon Vital" %></title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="stripe-public-key" content="<%= ENV['STRIPE_PUBLIC_KEY'] %>">
  <%= stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css", crossorigin: "anonymous" %>
  <%= stylesheet_link_tag "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css", rel: "stylesheet" %>



  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= yield :head %>

  <link rel="icon" href="/icon.png" type="image/png">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/icon.png">

  <%# Includes all stylesheet files in app/assets/stylesheets %>
  <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "custom_navbar", media: "all" %>  <!-- Ajout du CSS custom -->
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  <%= stylesheet_link_tag "https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/flatly/bootstrap.min.css", rel: "stylesheet" %>

  <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
</head>

<body>

  <nav class="navbar navbar-expand-lg custom-navbar-bg">
  <div class="container">
    <%= link_to root_path, class: "navbar-brand d-flex align-items-center text-white fw-bold" do %>
      <%= image_tag "Ac/PapillonVital_logo.png", alt: "Papillon Vital", width: 60, height: 60,
        class: "me-2 rounded-circle" %>
      Papillon Vital
    <% end %>

    <button class="navbar-toggler text-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <%= link_to products_path, class: "nav-link text-white px-3 d-flex align-items-center" do %>
            <i class="bi bi-box-seam me-2"></i> Nos Produits
          <% end %>
        </li>

        <li class="nav-item">
          <%= link_to recipes_path, class: "nav-link text-white px-3 d-flex align-items-center" do %>
            <i class="bi bi-journal-text me-2"></i> Recettes
          <% end %>
        </li>

        <% if user_signed_in? && current_user.admin == true %>
          <li class="nav-item">
            <%= link_to admin_dashboard_path, class: "nav-link text-white px-3 d-flex align-items-center" do %>
              <i class="bi bi-speedometer2 me-2"></i> Admin Dashboard
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to admin_products_path, class: "nav-link text-white px-3 d-flex align-items-center" do %>
              <i class="bi bi-pencil-square me-2"></i> Gérer les Produits
            <% end %>
          </li>
        <% end %>
      </ul>

      <% if user_signed_in? %>
        <ul class="navbar-nav">
          <li class="nav-item">
            <%= link_to orders_path, class: 'nav-link text-white d-flex align-items-center' do %>
              <i class="bi bi-receipt me-2"></i> Mes commandes
            <% end %>
          </li>
        </ul>
      <% end %>

      <ul class="navbar-nav">
        <% if user_signed_in? %>
          <li class="nav-item">
            <span class="nav-link text-white">
              <i class="bi bi-person-circle me-1"></i> Bonjour, <%= current_user.first_name %>
            </span>
          </li>
          <li class="nav-item">
            <%= link_to edit_user_registration_path, class: "nav-link text-white d-flex align-items-center" do %>
              <i class="bi bi-gear me-2"></i> Mon compte
            <% end %>
          </li>
          <li class="nav-item">
            <%= button_to destroy_user_session_path, method: :delete,
                data: { turbo_method: :delete },
                class: "nav-link text-white d-flex align-items-center",
                form: { class: "d-inline" } do %>
              <i class="bi bi-box-arrow-right me-2"></i> Déconnexion
            <% end %>
          </li>
        <% else %>
          <li class="nav-item">
            <%= button_to new_user_session_path,
                class: "nav-link text-white d-flex align-items-center" do %>
              <i class="bi bi-box-arrow-in-right me-2"></i> Connexion
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to new_user_registration_path, class: "nav-link text-white d-flex align-items-center" do %>
              <i class="bi bi-person-plus me-2"></i> Créer un compte
            <% end %>
          </li>
        <% end %>

        <!-- Lien panier toujours visible -->
        <li class="nav-item">
          <%= link_to cart_path, class: "nav-link text-white d-flex align-items-center" do %>
            <i class="bi bi-cart3 me-2"></i> Panier
          <% end %>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <%= yield %>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
  <%= javascript_importmap_tags %>
  <%= javascript_include_tag "application", type: "module" %>

</body>
<footer class="footer-luxe bg-light text-dark py-2 border-top border-2">
  <div class="container py-2">
    <div class="row gy-1 align-items-center justify-content-between">
      
      <!-- Logo + Nom -->
      <div class="col-md-4 text-center text-md-start">
        <div class="d-flex align-items-center gap-2 justify-content-center justify-content-md-start mb-1">
          <%= image_tag("Ac/PapillonVital_logo.png", alt: "Logo Papillon Vital", class: "logo-footer") %>
          <span class="fw-bold text-uppercase couleur-doree small"></span>
        </div>
        <p class="text-muted small mb-0">Beauté & Bien-être pour la thyroïdite d’Hashimoto</p>
      </div>

      <!-- Réseaux sociaux -->
      <div class="col-md-4 text-center">
        <small class="text-uppercase fw-semibold couleur-doree d-block mb-1">Suivez-nous</small>
        <div class="d-flex justify-content-center gap-3 fs-6">
          <a href="https://www.facebook.com/tonprofil" class="social-icon" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="https://github.com/AIDAIOANA" class="social-icon" aria-label="GitHub"><i class="fab fa-github"></i></a>
          <a href="#" onclick="installApp()" class="social-icon" aria-label="Installer l'app"><i class="fas fa-download"></i></a>
        </div>
      </div>

      <!-- Crédits -->
      <div class="col-md-4 text-center text-md-end">
        <small class="text-uppercase fw-semibold couleur-doree d-block mb-1">Crédits</small>
        <p class="text-muted small mb-0">
          Créé avec ❤️ par <a href="https://github.com/AIDAIOANA" class="text-decoration-underline text-dark">A&I</a>
        </p>
      </div>
    </div>

    <!-- Ligne séparatrice fine -->
    <hr class="my-2 ligne-separation" style="opacity: 0.3;" />

    <!-- Copyright -->
    <div class="text-center text-muted small fst-italic mt-1">
      © 2025 Papillon Vital — Tous droits réservés
    </div>

    <!-- Flash messages Papillon Vital -->
    <div class="row mt-2">
      <% if notice %>
        <div class="alert alert-papillon-success text-center py-2 px-3 mx-auto"><%= notice %></div>
      <% end %>
      <% if alert %>
        <div class="alert alert-papillon-error text-center py-2 px-3 mx-auto"><%= alert %></div>
      <% end %>
    </div>
    
  </div>
</footer>

</html>
